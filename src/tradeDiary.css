/* src/tradeDiary.css */
/* CSS variables are inherited from tokens.css - do not redefine here */

/* ルート / ヘッダ */
.td-root{ color: var(--ink); background: var(--bg); min-height: 100%; }
.td-header{ display:flex; align-items:center; justify-content:space-between; gap:12px; padding:12px 0; border-bottom:1px solid var(--line); }
.td-title{ font-size:20px; margin:0; }
.td-actions{ display:flex; gap:8px; }
.td-btn{ padding:8px 14px; border-radius:8px; border:1px solid var(--line); background: var(--surface); cursor:pointer; font-size:14px; font-weight:500; transition:all 0.2s ease; }
.td-btn:hover{ background:var(--chip); border-color:var(--accent); transform:translateY(-1px); box-shadow:0 2px 8px rgba(0,0,0,0.08); }
.td-btn:active{ transform:translateY(0); }
.td-btn.td-accent{ background:var(--accent); border-color:var(--accent); color:#fff; }
.td-btn.td-accent:hover{ background:var(--accent); opacity:0.9; }

/* カード・共通 */
.td-card{ background: var(--surface); border:1px solid var(--line); border-radius:12px; padding:16px; box-shadow:0 1px 3px rgba(0,0,0,0.02); }
.td-card-full{ margin-top:16px; }
.td-section-title{ display:flex; align-items:center; justify-content:space-between; margin-bottom:12px; }
.td-section-title h2{ margin:0; font-size:16px; font-weight:700; letter-spacing:0.2px; }
.subhead{ margin:0 0 8px 0; font-size:13px; color:var(--muted); }
.pill{ font-size:11px; color:var(--muted); background:var(--chip); padding:2px 8px; border-radius:6px; font-weight:500; }
.muted{ color:var(--muted); }
.small{ font-size:12px; }
.nowrap{ white-space:nowrap; }
.text-pos{ color: var(--accent-2, var(--accent)); }
.text-neg{ color: var(--danger, #ef4444); }
.accent-2{ color: var(--accent-2, var(--accent)); }
.danger{ color: var(--danger, #ef4444); }
.hr{ height:1px; background: var(--line); margin:12px 0; }

/* KPI Grid */
.td-root .kpi-grid{ display:grid; grid-template-columns:repeat(2, 1fr); gap:10px; width:100%; box-sizing:border-box; }
.td-root .kpi-grid .lab{ font-size:11px; color:var(--muted); margin-bottom:6px; font-weight:500; text-transform:uppercase; letter-spacing:0.5px; }
.td-root .kpi-grid .val{ font-weight:700; font-size:20px; line-height:1.2; word-break:break-word; }
@media (min-width: 640px) { .td-root .kpi-grid{ grid-template-columns:repeat(4, 1fr); } }

/* Nav button styling for Trade Diary */
.nav-btn {
  padding: 8px 12px;
  border: 1px solid var(--line, #e5e7eb);
  border-radius: 8px;
  background: var(--surface, #ffffff);
  cursor: pointer;
  font-size: 18px;
  transition: background-color 0.15s;
}

.nav-btn:hover {
  background: var(--chip, #f3f4f6);
}

/* 2列グリッド - 新レイアウト */
.grid-main{ display:grid; gap:16px; grid-template-columns:minmax(170px, 0.6fr) 1fr; }
@media (max-width:1080px){ .grid-main{ grid-template-columns:1fr; } }
.compact{ padding:12px; }

/* 表・表現 */
.kv{ display:grid; grid-template-columns:160px 1fr; row-gap:10px; column-gap:12px; }
.kv > div:nth-child(odd){ color:var(--muted); font-size:13px; font-weight:500; }
.kv > div:nth-child(even){ font-weight:500; }
.kv small{ font-size:12px; color:var(--muted); }
.pnl-two-cols{ display:grid; grid-template-columns:1fr 1fr; gap:12px; }
@media (max-width:720px){ .pnl-two-cols{ grid-template-columns:1fr; } }
table{ width:100%; border-collapse:separate; border-spacing:0 4px; }
th,td{ padding:10px 12px; border-bottom:1px solid var(--line); font-size:13px; background:transparent; }
td{ background:var(--surface); transition:all 0.15s ease; }
tr.row{ border-radius:8px; overflow:hidden; cursor:pointer; }
tr.row:hover td{ background:var(--chip, rgba(0, 0, 0, 0.03)) !important; }
td.num{ text-align:right; font-weight:600; }

/* 入力系 */
.row2{ display:grid; grid-template-columns:1fr 1fr; gap:12px; }
@media (max-width:720px){ .row2{ grid-template-columns:1fr; } }
.select,.input{ border:1px solid var(--line); background:var(--surface); color:var(--ink); border-radius:10px; padding:10px 12px; width:100%; text-align:left; font-size:14px; transition:all 0.2s ease; }
.select:hover,.input:hover{ border-color:var(--accent); }
.select:focus,.input:focus{ outline:none; border-color:var(--accent); box-shadow:0 0 0 3px rgba(14,165,233,0.1); }
.note{ width:100%; min-height:110px; border:1px solid var(--line); border-radius:12px; background:var(--surface); color:var(--ink); padding:12px; font-size:14px; line-height:1.6; transition:all 0.2s ease; }
.note:hover{ border-color:var(--accent); }
.note:focus{ outline:none; border-color:var(--accent); box-shadow:0 0 0 3px rgba(14,165,233,0.1); }
.note::placeholder{ color:var(--muted); opacity:0.6; }
.actions{ display:flex; gap:8px; justify-content:flex-end; margin-top:10px; }

/* Single column layout for form inputs */
.td-card label{ display:block; margin-bottom:12px; }
.td-card label:last-child{ margin-bottom:0; }

/* 日記サブカード */
.subcard{ border:1px solid var(--line); border-radius:12px; background:var(--surface); padding:12px; margin-bottom:12px; }

/* タグ */
.chips-wrap{ max-height:48px; overflow:auto; padding-right:4px; }
.chips{ display:flex; flex-wrap:wrap; gap:6px; }
.chip{ background:rgba(14,165,233,.12); color:var(--accent); border:1px solid rgba(14,165,233,.25); padding:4px 10px; border-radius:6px; font-size:12px; font-weight:500; cursor:pointer; transition:all 0.2s ease; }
.chip:hover{ background:rgba(14,165,233,.2); border-color:var(--accent); transform:translateY(-1px); box-shadow:0 2px 6px rgba(14,165,233,0.15); }

/* マルチセレクト */
.ms-wrap{ position:relative; }
.ms-trigger{ border:1px solid var(--line); background:var(--surface); color:var(--ink); border-radius:10px; padding:10px 12px; width:100%; text-align:left; font-size:14px; cursor:pointer; transition:all 0.2s ease; }
.ms-trigger:hover{ border-color:var(--accent); background:var(--chip); }
.ms-menu{
  position:absolute; z-index:20; left:0; right:0; top:calc(100% + 6px);
  background:var(--surface); border:1px solid var(--line); border-radius:12px; box-shadow:0 8px 32px rgba(0,0,0,.15);
  padding:8px; max-height:280px; overflow:auto; font-size:13px; line-height:1.5;
}
.ms-item{ display:flex; gap:8px; align-items:center; padding:10px; border-radius:8px; cursor:pointer; transition:all 0.15s ease; }
.ms-item:hover{ background:var(--chip); transform:translateX(2px); }
.ms-footer{ display:flex; justify-content:space-between; align-items:center; padding:8px 4px 0; color:var(--muted); font-size:12px; border-top:1px solid var(--line); margin-top:4px; }

/* 画像 */
.upanel{ border:1px dashed var(--line); border-radius:12px; background:var(--chip); padding:12px; transition:all 0.2s ease; }
.upanel:hover{ border-color:var(--accent); background:rgba(14,165,233,0.05); }
.uactions{ display:flex; align-items:center; gap:8px; margin-bottom:10px; }
.uactions .right{ margin-left:auto; }
.thumbs{ display:grid; grid-template-columns:repeat(3,1fr); gap:10px; margin-top:10px; }
.thumb{ position:relative; border:1px solid var(--line); border-radius:10px; overflow:hidden; height:120px; background:var(--surface); display:flex; align-items:center; justify-content:center; transition:all 0.2s ease; cursor:pointer; }
.thumb:hover{ border-color:var(--accent); transform:scale(1.02); box-shadow:0 4px 12px rgba(0,0,0,0.1); }
.thumb img{ max-height:100%; max-width:100%; display:block; object-fit:cover; }
.thumb .del{ position:absolute; top:6px; right:6px; border:none; background:rgba(0,0,0,.7); color:#fff; border-radius:6px; padding:4px 8px; font-size:11px; font-weight:600; cursor:pointer; transition:all 0.2s ease; }
.thumb .del:hover{ background:var(--danger, #ef4444); transform:scale(1.05); }

/* モーダル（画像/クイック日記/タグ） */
.img-modal{ position:fixed; inset:0; background:rgba(0,0,0,.7); display:flex; align-items:center; justify-content:center; z-index:80; }
.img-modal[aria-hidden="true"]{ display:none; }
.img-modal img{ max-width:90vw; max-height:90vh; border-radius:12px; box-shadow:0 12px 30px rgba(0,0,0,.35); }

.modal{ position:fixed; inset:0; background:rgba(0,0,0,.35); display:flex; align-items:center; justify-content:center; z-index:50; }
.modal[aria-hidden="true"]{ display:none; }
.modal .panel{ background:var(--bg); color:var(--ink); border:1px solid var(--line); border-radius:16px; max-width:760px; width:92%; padding:14px; max-height:80vh; overflow:auto; font-size:13px; }
.modal .top{ display:flex; justify-content:space-between; align-items:center; gap:12px; }
.modal .top h3{ margin:0; font-size:14px; }

/* チャート */
.charts{ display:grid; gap:16px; grid-template-columns:repeat(3,1fr); }
@media (max-width:1080px){ .charts{ grid-template-columns:1fr; } }
.chart-card{ background:var(--surface); border:1px solid var(--line); border-radius:12px; padding:14px; display:flex; flex-direction:column; box-shadow:0 1px 3px rgba(0,0,0,0.02); }
.chart-card h4{ margin:0 0 10px 0; font-size:14px; font-weight:700; display:flex; justify-content:space-between; align-items:center; }
.legend{ font-size:12px; color:var(--muted); font-weight:500; }

/* チャートのサイズ安定 */
.chart-box{ position:relative; width:100%; height:260px; }
.chart-box > canvas{ width:100% !important; height:100% !important; display:block; flex:0 0 auto; }

/* リンク済みメモテーブル */
.linked-memos-table{ overflow-x:auto; }
.linked-memos-table table{ width:100%; border-collapse:collapse; }
.linked-memos-table th{ text-align:left; font-weight:600; padding:12px; border-bottom:1px solid var(--line); font-size:13px; background:var(--chip); }
.linked-memos-table td{ padding:12px; border-bottom:1px solid var(--line); font-size:13px; }
.linked-memos-table tbody tr{ transition:all 0.15s ease; }
.linked-memos-table tbody tr:hover{ background:var(--chip); }

/* 保留メモ */
.pending-list{ display:grid; gap:10px; }
.pending-card{ border:1px solid var(--line); border-radius:10px; background:var(--chip); padding:14px; display:grid; grid-template-columns:1fr auto; gap:12px; align-items:center; transition:all 0.2s ease; }
.pending-card:hover{ border-color:var(--accent); box-shadow:0 2px 8px rgba(0,0,0,0.06); }
.pending-meta{ font-size:12px; color:var(--muted); margin-top:4px; }
.pending-actions{ display:flex; gap:8px; }

/* 左下ショートカット（詳細な定義は下部にあります） */

/* メモ欄のグリッド（補強） */
.note-grid{ display:grid; grid-template-columns:1fr 1fr; gap:10px; }
@media (max-width:720px){ .note-grid{ grid-template-columns:1fr; } }
/* ==== モーダルを最前面に（他UIより上へ） ==== */
.modal{
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,.40);
  display: flex;
  align-items: center;
  justify-content: center;
  z-index: 9999;           /* ← もともと50。十分に高くします */
}
.modal .panel{
  position: relative;
  background: var(--bg);
  color: var(--ink);
  border: 1px solid var(--line);
  border-radius: 16px;
  width: 92%;
  max-width: 760px;
  max-height: 80vh;
  overflow: auto;
  padding: 14px;
  font-size: 13px;
  box-shadow: 0 16px 40px rgba(0,0,0,.30);
}

/* 左下の「＋ 新しい日記をつける」ボタンが他UIの下に潜らないように */
.quick-btn{
  position: fixed;
  left: calc(var(--sidenav-w) + 20px);
  bottom: 20px;
  z-index: 10000;
  background: var(--accent);
  color: #fff;
  border: none;
  border-radius: 999px;
  padding: 12px 16px;
  font-weight: 700;
  box-shadow: 0 6px 16px rgba(0,0,0,.18);
  cursor: pointer;
  white-space: nowrap;
}

/* モバイルでは左端に配置 */
@media (max-width: 1024px) {
  .quick-btn {
    left: 20px;
  }
}

/* ドロップゾーンはクリック可能に（親のflex影響を受けない） */
.dropzone{
  position: relative;
  z-index: 1;
  cursor: pointer;
}

/* テーブルの行がradiusでクリップされず見えなくなるのを防ぐ */

/* メイン領域が空の時も圧縮されないよう最低高を確保 */
.diary-list {
  min-height: 360px;  /* お好みで 320〜480px に調整可 */
}

/* ヘッダー右側のボタン折返し防止（モバイルでの見栄えを少し安定） */
.td-actions .td-btn { white-space: nowrap; }

/* 新規日記ダイアログの2列グリッドと余白 */
.dlg-grid{
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: 12px;
  margin-top: 8px;
}
@media (max-width: 720px){
  .dlg-grid{ grid-template-columns: 1fr; }
}

/* 画像添付: 大きめドロップゾーン（クリックでファイル選択） */
.dropzone-large{
  border: 2px dashed var(--line);
  border-radius: 12px;
  background: var(--bg);
  color: var(--muted);
  height: 180px;                 /* スペースの余裕 */
  display: grid;
  place-items: center;
  cursor: pointer;
}
.dropzone-large:focus{
  outline: none;
  box-shadow: 0 0 0 2px rgba(14,165,233,.25);
}
.dlg-grid{ display:grid; grid-template-columns:1fr 1fr; gap:12px; margin-top:8px; }
@media (max-width:720px){ .dlg-grid{ grid-template-columns:1fr; } }
.time-row{ display:grid; grid-template-columns:1fr auto 8px auto; align-items:center; gap:8px; }
.time-select{ width:84px; } .time-sep{ width:8px; text-align:center; color:var(--muted); }
.diary-list{ min-height:360px; }
.dropzone-large{ border:2px dashed var(--line); border-radius:12px; background:var(--bg); color:var(--muted); height:180px; display:grid; place-items:center; cursor:pointer; }
.modal{ z-index:9999; } .quick-btn{ z-index:10000; }

/* 取引一覧のホバーエフェクト */
.trade-row {
  cursor: pointer;
}
.trade-row td {
  transition: background-color 0.15s ease;
}
.trade-row:hover td {
  background-color: rgba(0, 0, 0, 0.03) !important;
}

/* トレード日記詳細ページのレイアウト調整 */

/* カードは内容に応じて自動調整 */
.td-entry-exit,
#pnlCard,
.td-entry-before,
.td-position-hold,
#imageCard,
.td-exit,
.td-viz {
  height: auto;
}

/* エントリー/エグジットと損益内訳の高さを揃える */
.td-match-height {
  min-height: 280px;
}

/* トレード日記見出しの高さ統一 */
.td-diary-heading {
  height: 52px;
}

/* 縦並びレイアウト */
.note-vertical {
  display: flex;
  flex-direction: column;
  gap: 12px;
}

.note-vertical label {
  margin-bottom: 0;
}

.charts-vertical {
  display: flex;
  flex-direction: column;
  gap: 16px;
}
